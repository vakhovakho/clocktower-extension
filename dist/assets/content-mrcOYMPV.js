const d="LOAD_STYLES",u="UNLOAD_STYLES",m={childList:!0,subtree:!0},i=new MutationObserver(e=>{for(let t=0;t<e.length;t++){let n=e[t].target.classList;(n.contains("channel")||n.contains("list"))&&(f(),v())}});function c(){let e=setInterval(()=>{const t=document.getElementById("channels");t&&(i.observe(t,m),clearInterval(e))},2e3)}function y(){i.disconnect()}function h(){var n;let e=document.querySelectorAll("#whispers li.video.storyteller"),t=document.querySelectorAll("ul.storytellers .storyteller .chat");for(let o=0;o<e.length;o++){let s=e[o].querySelector("video");if(s){let l=document.createElement("video");l.autoplay=!0,l.playsInline=!0,l.disablePictureInPicture=!0,l.disableRemotePlayback=!0,l.srcObject=s.srcObject;let r=document.createElement("div");r.classList.add("video"),r.appendChild(l),t[o]&&((n=t[o].querySelector(".video"))==null||n.remove(),t[o].appendChild(r))}}}function v(){setTimeout(h,0)}function f(){var t;let e=document.querySelectorAll("ul.storytellers .storyteller .chat");for(let n=0;n<e.length;n++)(t=e[n].querySelector(".video"))==null||t.remove()}async function a(){return fetch("https://raw.githubusercontent.com/vakhovakho/clocktower-online-georgia-public/main/custom-css.css").then(e=>e.text()).then(e=>{let t=document.getElementById("mastermind-style");t&&t.remove();var n=document.createElement("style");n.id="mastermind-style",n.type="text/css",n.innerHTML=e,document.head.appendChild(n)})}chrome.storage.local.get(["styleLoaded"]).then(async e=>{if(e.styleLoaded===1)try{await a(),c()}catch(t){console.error(t)}});chrome.runtime.onMessage.addListener(function(e,t,n){if(e.action===d&&(a(),c()),e.action===u){let o=document.getElementById("mastermind-style");o&&o.remove(),y()}});
