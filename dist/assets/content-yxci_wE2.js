const u="LOAD_STYLES",m="UNLOAD_STYLES",y={childList:!0,subtree:!0},c=new MutationObserver(e=>{for(let t=0;t<e.length;t++){let o=e[t].target.classList;if(o.contains("channel")||o.contains("list")){let l=document.querySelectorAll("#whispers li.video.storyteller");for(let r=0;r<l.length;r++){let n=l[r].querySelector("video");n&&(S(r),f(r,n))}break}}});function a(){let e=setInterval(()=>{const t=document.getElementById("channels");t&&(c.observe(t,y),clearInterval(e))},2e3)}function h(){c.disconnect()}function v(e,t){var l;console.log("moveSTVideoFromWhisper",e);let o=document.querySelectorAll("ul.storytellers li.storyteller");for(let r=0;r<o.length;r++)if(r===e){console.log("aaaa");let n=document.createElement("video");n.autoplay=!0,n.playsInline=!0,n.disablePictureInPicture=!0,n.disableRemotePlayback=!0,n.srcObject=t.srcObject;let s=document.createElement("div");s.classList.add("video"),s.appendChild(n);let i=o[r].querySelector(".chat");i&&(console.log("bbbb"),(l=i.querySelector(".video"))==null||l.remove(),i.appendChild(s));break}}function f(e,t){setTimeout(v,0,e,t)}function S(e){var o;let t=document.querySelectorAll("ul.storytellers .storyteller");for(let l=0;l<t.length;l++)l===e&&((o=t[l].querySelector(".video"))==null||o.remove())}async function d(){return fetch("https://raw.githubusercontent.com/vakhovakho/clocktower-online-georgia-public/main/custom-css.css").then(e=>e.text()).then(e=>{let t=document.getElementById("mastermind-style");t&&t.remove();var o=document.createElement("style");o.id="mastermind-style",o.type="text/css",o.innerHTML=e,document.head.appendChild(o)})}chrome.storage.local.get(["styleLoaded"]).then(async e=>{if(e.styleLoaded===1)try{await d(),a()}catch(t){console.error(t)}});chrome.runtime.onMessage.addListener(function(e,t,o){if(e.action===u&&(d(),a()),e.action===m){let l=document.getElementById("mastermind-style");l&&l.remove(),h()}});
